
-- Merging all player stats into one table
CREATE TABLE player_stat AS
      SELECT * FROM phs_2018_stage_1
   UNION ALL
      SELECT * FROM phs_2018_stage_2
   UNION ALL
      SELECT * FROM phs_2018_stage_3
   UNION ALL
      SELECT * FROM phs_2018_stage_4
   UNION ALL
      SELECT * FROM phs_2018_playoffs
   UNION ALL
      SELECT * FROM phs_2019_stage_1
   UNION ALL
      SELECT * FROM phs_2019_stage_2
   UNION ALL
      SELECT * FROM phs_2019_stage_3
   UNION ALL
      SELECT * FROM phs_2019_stage_4
   UNION ALL
      SELECT * FROM phs_2019_playoffs
   UNION ALL
      SELECT * FROM phs_2020_1
   UNION ALL
      SELECT * FROM phs_2020_2
   UNION ALL
      SELECT * FROM phs_2021_1


-- Ensures all day fields in start_time are double digit
      UPDATE player_stat
         SET start_time = SUBSTR(start_time, 1, 3) || '0' || SUBSTR(start_time, 4)
       WHERE SUBSTR(start_time, 5, 1) = '/';

-- Ensures all start_time dates follow "YYYY-MM-DD hh:mm" format
      UPDATE player_stat
         SET start_time = SUBSTR(start_time, 7, 4) || '-' || SUBSTR(start_time, 1, 2) || '-' ||
                          SUBSTR(start_time, 4, 2) ||  SUBSTR(start_time, 11)
       WHERE SUBSTR(start_time, 3, 1) = '/';
       
-- Ensures all hour fields in start_time are double digit
      UPDATE player_stat
         SET start_time = SUBSTR(start_time, 1, 11) || '0' || SUBSTR(start_time, 12)
       WHERE SUBSTR(start_time, 13, 1) = ':';
       
